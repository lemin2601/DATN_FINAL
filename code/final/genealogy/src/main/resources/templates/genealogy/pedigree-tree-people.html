<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head th:replace="/fragments/user :: head"> </head>

<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">



    <!-- Main Header -->
    <header th:replace="/fragments/user :: header"> </header>

    <!-- Left side column. contains the logo and sidebar -->
    <aside th:replace="/fragments/user :: aside_menu"> </aside>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">

        <!-- Content Header (Page header) -->
        <section class="content-header">
            <h1 th:text="#{genealogy.header}">
            </h1>
            <ol class="breadcrumb">
                <li class="active"  ><a href="/genealogy"><i class="fa fa-dashboard"></i><span th:text="#{genealogy}"></span></a></li>
            </ol>
        </section>

        <!-- Main content -->
        <section class="content">
            <!-- Your Page Content Here -->
            <link rel="stylesheet" th:href="@{/css/jquery-ui.css}"/>
            <div class="box box-info" id="containment-wrapper" >
                <div class="chart" id="collapsable-example"></div>
            </div>

        </section>
        <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->

    <footer th:replace="/fragments/user :: footer"/>

    <!-- Control Sidebar -->
    <aside th:replace="/fragments/user :: aside"/>
    <!-- /.control-sidebar -->
    <!-- Add the sidebar's background. This div must be placed
         immediately after the control sidebar -->
    <div class="control-sidebar-bg"></div>



    <!-- Modal view info -->
    <div class="modal fade" id="modalViewInfo" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Modal Header</h4>
                </div>
                <div class="modal-body">
                    <p>Some text in the modal.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

        </div>
    </div>
    <!-- end modal view info -->
    <!-- modal edit info -->
    <div class="modal fade" id="modalEditInfo" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Modal Header</h4>
                </div>
                <div class="modal-body">
                    <p>Some text in the modal.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

        </div>
    </div>
    <!-- end modal edit info -->
</div>
<!-- ./wrapper -->

<!-- REQUIRED JS SCRIPTS -->
<div th:replace="/fragments/user :: js"/>
<script th:src="@{/treant/vendor/raphael.js}"></script>
<script th:src="@{/treant/Treant.js}"></script>
<script th:src="@{/treant/collapsable.js}"></script>

<link th:href="@{/treant/vendor/perfect-scrollbar/perfect-scrollbar.css}" rel="stylesheet" type="text/css"/>
<script th:src="@{/treant/vendor/jquery.easing.js}"></script>
<script th:src="@{/treant/vendor/jquery.mousewheel.js}"></script>
<script th:src="@{/treant/vendor/perfect-scrollbar/perfect-scrollbar.js}"></script>


<script th:src="@{/js/jquery-ui.js}"></script>

<script th:inline="javascript">
    /*<![CDATA[*/
    var idGenealogy = [[${idGenealogy}]];
    var idPedigree = [[${idPedigree}]];
    $.ajax({
        type: "GET",
        url: "/rest/genealogy/"+idGenealogy+"/pedigree/"+idPedigree+"/list-people-tree",
        processData: false, //prevent jQuery from automatically transforming the data into a query string
        contentType: false,
        cache: false,
        timeout: 600000,
        success: function (data) {
            new Treant( data ,initViewDetailNode);
            console.log("SUCCESS : ", data);
            console.log(JSON.stringify(data));

        },
        error: function (e) {
            console.log("ERROR : ", e);
        }
    });

    var initViewDetailNode = function () {
        console.log("init view detail node");
        $(".people_chart_node").append('' +
            '<div class="people_chart_node_edit">' +
            '<a onclick="viewRelation(this)"><i class="fa fa-check-square-o fa-lg"></i></a>  ' +
            '<a onclick="editInfoNode(this)"><i class="fa fa-pencil fa-lg"></i></a>  ' +
            '<a href="#" onclick="viewInfoNode(this)"><i class="fa fa-eye fa-lg"></i></a>  ' +
            '</div>');
    };

    var viewRelation = function (sender) {
        var id = $(sender).parent().parent().attr('id');
        console.log('viewRelation' + id);
        $("#modalEditInfo").modal();
    };


    var editInfoNode = function (sender) {
        var id = $(sender).parent().parent().attr('id');
        console.log('editInfoNode' + id);
        $("#modalEditInfo").modal();
    };

    var viewInfoNode = function (sender) {
        var id = $(sender).parent().parent().attr('id');
        console.log('viewInfoNode:' + id);
        $("#modalViewInfo").modal();

    };


    /*]]>*/
</script>

<script type="text/javascript">

</script>
</body>
</html>
